import express, { Express, Response, Request } from 'express';
import session from 'express-session';

// @ts-ignore
declare module 'express-session' {  
  interface SessionData {
    times?: number;
  }
}

const application: Express = express();

application.use(
  session({
    secret: 'cs123lab6',
    resave: false,
    saveUninitialized: true,
    cookie: { maxAge: 360_000 }
  })
);

application.get('/', (request: Request, response: Response) => {
  request.session.times = (request.session.times || 0) + 1;
  response.send('Times visited: ' + request.session.times);
});

application.listen(3000, () => {
  console.log([server]: Server is running);
});